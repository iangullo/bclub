<table>
	<tr>
		<th rowspan="2" align="right" class="align-center text-indigo-900"><%= t("target.abbr") %></th>
		<%= render "targets_form", form: form, event_targets: @event.def_targets, aspect: 0, focus: 2, label: t("target.focus.def_a") %>
		<th align="left" class="bg-indigo-900 text-gray-300 align-center border px py"><%= t("train.duration") %></th>
	</tr><tr>
		<%= render "targets_form", form: form, event_targets: @event.off_targets, aspect: 0, focus: 1, label: t("target.focus.ofe_a") %>
		<th align="center" class="border px py">
			<%= form.number_field :duration, value: @event.duration, min: 60, max: 120, size: 3, step: 15, class: "rounded py-0 px-1 shadow-inner text-right border-gray-200 bg-gray-50 focus:ring-blue-700 focus:border-blue-700"%>
		</th>
	</tr><tr>
		<td colspan="4" class="text-xs"><br></td>
	</tr>
</table>
<table>
	<% if @event.id # only allow editing tasks if we're not creating it from scratch %>
		<tr>
			<th colspan="2" align="left" class="text-indigo-900 align-center"><%= t("task.many") %></th>
		</tr><tr>
			<td colspan="2" align="left" class="align-top">
				<%#= render NestedComponent.new(model: "event", key: "tasks", form: form, child: Task.new(order: @event.tasks.count+1), row: "task_row", order: "order", btn_add: nil) %>
				<% t_cls = "draggable bg-gray-100 text-left text-gray-700 rounded-md hover:bg-gray-500 hover:text-indigo-100 focus:bg-indigo-900 focus:text-gray-200 focus:ring-blue-900" %>
				<% f_cls = "align-middle rounded shadow-inner border-indigo-100 focus:ring-indigo-300 border-1 py-0 px-0 m-1" %>
				<turbo-frame id="sortable-list" class="contents">
					<div data-controller="sortable flex" data-sortable-animation-value="150" style="display: grid; grid-template-columns: 1fr;">
						<%= form.fields_for :tasks, @event.tasks.order(:order) do |ff| %>
							<div class="<%= t_cls %>">
								<%= ff.hidden_field :id %>
								<%= ff.hidden_field :order %>
								<%= ff.hidden_field :_destroy %>
								<div class="float-left">
									<%= ff.object.drill.nice_string %>
								</div>
								<div class="float-right">
									<%= ff.number_field :duration, value: ff.object.duration, min: 1, max: 90, size: 3, class: f_cls + " px-0 text-right", style: "background-color: transparent; border: indigo-100;" %>
									<%= render ButtonComponent.new(button: { kind: 'edit', align: "right", url: edit_task_event_path(task_id: ff.object.id) }) %>
									<%= render ButtonComponent.new(button: { kind: 'remove', action: 'click->sortable#remove', frame: 'sortable-list', data: {target: 'sortable.item', id: ff.object.id ,prevent_default: true} }) %>
								</div>
							</div>
						<% end %>
					</div>
				</turbo-frame>
			</td>
		</tr><tr>
			<td align="left">
				<% if u_admin? or @event.team.has_coach(u_coachid)  %>
					<%= render @btn_add %>
				<% end %>
			</td>
			<th align="left"><%= t("stat.total_a") + " " + @event.work_duration %></th>
		</tr>
	<% end %>
</table>
